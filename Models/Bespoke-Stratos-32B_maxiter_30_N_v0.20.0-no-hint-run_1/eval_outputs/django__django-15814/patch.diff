diff --git a/db.sqlite3 b/db.sqlite3
new file mode 100644
index 0000000000..2e73657e69
Binary files /dev/null and b/db.sqlite3 differ
diff --git a/tests/manage.py b/tests/manage.py
new file mode 100755
index 0000000000..eee23dc5ae
--- /dev/null
+++ b/tests/manage.py
@@ -0,0 +1,15 @@
+#!/usr/bin/env python
+import os
+import sys
+
+if __name__ == "__main__":
+    os.environ.setdefault("DJANGO_SETTINGS_MODULE", "tests.settings")
+    try:
+        from django.core.management import execute_from_command_line
+    except ImportError as exc:
+        raise ImportError(
+            "Couldn't import Django. Are you sure it's installed and "
+            "available on your PYTHONPATH environment variable? Did you "
+            "forget to activate a virtual environment?"
+        ) from exc
+    execute_from_command_line(sys.argv)
\ No newline at end of file
diff --git a/tests/settings.py b/tests/settings.py
new file mode 100644
index 0000000000..9251396857
--- /dev/null
+++ b/tests/settings.py
@@ -0,0 +1,15 @@
+import os
+
+BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
+
+INSTALLED_APPS = [
+    'django.contrib.contenttypes',
+    'test_proxy',
+]
+
+DATABASES = {
+    'default': {
+        'ENGINE': 'django.db.backends.sqlite3',
+        'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
+    }
+}
\ No newline at end of file
diff --git a/tests/test_proxy/management/commands/test_proxy.py b/tests/test_proxy/management/commands/test_proxy.py
new file mode 100644
index 0000000000..35c724c003
--- /dev/null
+++ b/tests/test_proxy/management/commands/test_proxy.py
@@ -0,0 +1,12 @@
+from django.core.management.base import BaseCommand
+from ...models import AnotherModel
+
+class Command(BaseCommand):
+    def handle(self, *args, **options):
+        # Create some data
+        custom = ProxyCustomModel.objects.create(name='Test')
+another = AnotherModel.objects.create(custom=custom)
+another = AnotherModel.objects.create(custom=custom)
+        # Trigger the error
+        objs = list(AnotherModel.objects.select_related("custom").only("custom__name").all())
+        print(objs)
\ No newline at end of file
diff --git a/tests/test_proxy/migrations/0001_initial.py b/tests/test_proxy/migrations/0001_initial.py
new file mode 100644
index 0000000000..48443a0171
--- /dev/null
+++ b/tests/test_proxy/migrations/0001_initial.py
@@ -0,0 +1,62 @@
+# Generated by Django 4.2.dev20220702144524 on 2025-02-10 06:25
+
+from django.db import migrations, models
+import django.db.models.deletion
+
+
+class Migration(migrations.Migration):
+
+    initial = True
+
+    dependencies = []
+
+    operations = [
+        migrations.CreateModel(
+            name="CustomModel",
+            fields=[
+                (
+                    "id",
+                    models.AutoField(
+                        auto_created=True,
+                        primary_key=True,
+                        serialize=False,
+                        verbose_name="ID",
+                    ),
+                ),
+                ("name", models.CharField(max_length=16)),
+            ],
+        ),
+        migrations.CreateModel(
+            name="ProxyCustomModel",
+            fields=[],
+            options={
+                "proxy": True,
+                "indexes": [],
+                "constraints": [],
+            },
+            bases=("test_proxy.custommodel",),
+        ),
+        migrations.CreateModel(
+            name="AnotherModel",
+            fields=[
+                (
+                    "id",
+                    models.AutoField(
+                        auto_created=True,
+                        primary_key=True,
+                        serialize=False,
+                        verbose_name="ID",
+                    ),
+                ),
+                (
+                    "custom",
+                    models.ForeignKey(
+                        blank=True,
+                        null=True,
+                        on_delete=django.db.models.deletion.SET_NULL,
+                        to="test_proxy.proxycustommodel",
+                    ),
+                ),
+            ],
+        ),
+    ]
diff --git a/tests/test_proxy/migrations/__init__.py b/tests/test_proxy/migrations/__init__.py
new file mode 100644
index 0000000000..e69de29bb2
diff --git a/tests/test_proxy/models.py b/tests/test_proxy/models.py
new file mode 100644
index 0000000000..e1ac497838
--- /dev/null
+++ b/tests/test_proxy/models.py
@@ -0,0 +1,16 @@
+from django.db import models
+
+class CustomModel(models.Model):
+    name = models.CharField(max_length=16)
+
+class ProxyCustomModel(CustomModel):
+    class Meta:
+        proxy = True
+
+class AnotherModel(models.Model):
+    custom = models.ForeignKey(
+        ProxyCustomModel,
+        on_delete=models.SET_NULL,
+        null=True,
+        blank=True,
+    )
\ No newline at end of file
