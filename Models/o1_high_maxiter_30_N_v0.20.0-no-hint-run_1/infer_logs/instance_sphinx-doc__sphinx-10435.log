2024-12-23 07:11:34,426 - INFO - Building image: ghcr.io/all-hands-ai/runtime:oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm
2024-12-23 07:13:28,238 - INFO - Image [ghcr.io/all-hands-ai/runtime:oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm] build finished.
2024-12-23 07:13:28,247 - INFO - Re-tagged image [ghcr.io/all-hands-ai/runtime:oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm] with more generic tag [oh_v0.16.0_o4l1rb3zblhp7jbn]
2024-12-23 07:13:28,249 - INFO - Image ghcr.io/all-hands-ai/runtime with tags [oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm, oh_v0.16.0_o4l1rb3zblhp7jbn] built successfully
2024-12-23 07:13:28,255 - INFO - [runtime 416ca8d4-89cb-4c15-9be7-9726db519f2d-c991128e36b705ca] Starting runtime with image: ghcr.io/all-hands-ai/runtime:oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm
2024-12-23 07:13:28,655 - INFO - [runtime 416ca8d4-89cb-4c15-9be7-9726db519f2d-c991128e36b705ca] Container started: openhands-runtime-416ca8d4-89cb-4c15-9be7-9726db519f2d-c991128e36b705ca. VSCode URL: None
2024-12-23 07:13:28,658 - INFO - [runtime 416ca8d4-89cb-4c15-9be7-9726db519f2d-c991128e36b705ca] Waiting for client to become ready at http://localhost:35044...
2024-12-23 07:13:48,722 - INFO - [runtime 416ca8d4-89cb-4c15-9be7-9726db519f2d-c991128e36b705ca] Runtime is ready.
2024-12-23 07:13:48,838 - INFO - ------------------------------
2024-12-23 07:13:48,838 - INFO - BEGIN Runtime Initialization Fn
2024-12-23 07:13:48,838 - INFO - ------------------------------
2024-12-23 07:13:48,839 - INFO - **CmdRunAction (source=None)**
COMMAND:
echo 'export SWE_INSTANCE_ID=sphinx-doc__sphinx-10435' >> ~/.bashrc && echo 'export PIP_CACHE_DIR=~/.cache/pip' >> ~/.bashrc && echo "alias git='git --no-pager'" >> ~/.bashrc
2024-12-23 07:13:48,948 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-23 07:13:48,948 - INFO - **CmdRunAction (source=None)**
COMMAND:
export USER=$(whoami); echo USER=${USER} 
2024-12-23 07:13:49,055 - INFO - **CmdOutputObservation (source=None, exit code=0)**
USER=root
2024-12-23 07:13:49,056 - INFO - **CmdRunAction (source=None)**
COMMAND:
mkdir -p /swe_util/eval_data/instances
2024-12-23 07:13:49,163 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-23 07:13:49,170 - INFO - **CmdRunAction (source=None)**
COMMAND:
cat ~/.bashrc
2024-12-23 07:13:49,277 - INFO - **CmdOutputObservation (source=None, exit code=0)**
source /opt/miniconda3/etc/profile.d/conda.sh && conda activate testbed
export SWE_INSTANCE_ID=sphinx-doc__sphinx-10435
export PIP_CACHE_DIR=~/.cache/pip
alias git='git --no-pager'
2024-12-23 07:13:49,277 - INFO - **CmdRunAction (source=None)**
COMMAND:
source ~/.bashrc
2024-12-23 07:13:49,482 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-23 07:13:49,482 - INFO - **CmdRunAction (source=None)**
COMMAND:
source /swe_util/instance_swe_entry.sh
2024-12-23 07:13:49,985 - INFO - **CmdOutputObservation (source=None, exit code=0)**
WORKSPACE_NAME: sphinx-doc__sphinx__5.0
2024-12-23 07:13:49,985 - INFO - **CmdRunAction (source=None)**
COMMAND:
cd /workspace/sphinx-doc__sphinx__5.0
2024-12-23 07:13:50,091 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-23 07:13:50,091 - INFO - **CmdRunAction (source=None)**
COMMAND:
git reset --hard
2024-12-23 07:13:50,378 - INFO - **CmdOutputObservation (source=None, exit code=0)**
HEAD is now at f1061c012 Merge pull request #10365 from LuisBL/10363-sphinxmaketitle-should-use-linewidth-fix
2024-12-23 07:13:50,378 - INFO - **CmdRunAction (source=None)**
COMMAND:
for remote_name in $(git remote); do git remote remove "${remote_name}"; done
2024-12-23 07:13:50,486 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-23 07:13:50,486 - INFO - ------------------------------
2024-12-23 07:13:50,486 - INFO - END Runtime Initialization Fn
2024-12-23 07:13:50,486 - INFO - ------------------------------
2024-12-23 07:13:50,487 - INFO - Function calling not enabled for model openai/neulab/o1. Mocking function calling via prompting.
2024-12-23 07:13:50,490 - INFO - [Agent Controller default] Starting step loop...
2024-12-23 07:13:50,490 - INFO - [Agent Controller default] Setting agent(CodeActAgent) state from AgentState.LOADING to AgentState.RUNNING
2024-12-23 07:13:51,592 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 0 GLOBAL STEP 0
2024-12-23 07:13:51,821 - ERROR - [Agent Controller default] Error while running the agent: litellm.BadRequestError: OpenAIException - Error code: 400 - {'error': {'message': 'Budget has been exceeded! Current cost: 2501.878305000001, Max budget: 2500.0', 'type': 'budget_exceeded', 'param': None, 'code': '400'}}
2024-12-23 07:13:51,822 - INFO - [Agent Controller default] Setting agent(CodeActAgent) state from AgentState.RUNNING to AgentState.ERROR
2024-12-23 07:13:51,822 - ERROR - litellm.BadRequestError: OpenAIException - Error code: 400 - {'error': {'message': 'Budget has been exceeded! Current cost: 2501.878305000001, Max budget: 2500.0', 'type': 'budget_exceeded', 'param': None, 'code': '400'}}
2024-12-23 07:13:51,822 - INFO - [Agent Controller default] Setting agent(CodeActAgent) state from AgentState.ERROR to AgentState.ERROR
2024-12-23 07:13:52,494 - INFO - ------------------------------
2024-12-23 07:13:52,494 - INFO - BEGIN Runtime Completion Fn
2024-12-23 07:13:52,494 - INFO - ------------------------------
2024-12-23 07:13:52,494 - INFO - **CmdRunAction (source=None)**
COMMAND:
cd /workspace/sphinx-doc__sphinx__5.0
2024-12-23 07:13:52,601 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-23 07:13:52,601 - INFO - **CmdRunAction (source=None)**
COMMAND:
git config --global core.pager ""
2024-12-23 07:13:52,710 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-23 07:13:52,710 - INFO - **CmdRunAction (source=None)**
COMMAND:
git add -A
2024-12-23 07:13:52,910 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-23 07:13:52,910 - INFO - **CmdRunAction (source=None)**
COMMAND:
git diff --no-color --cached f1061c012e214f16fd8790dec3c283d787e3daa8
2024-12-23 07:13:53,021 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-23 07:13:53,021 - INFO - ------------------------------
2024-12-23 07:13:53,021 - INFO - END Runtime Completion Fn
2024-12-23 07:13:53,022 - INFO - ------------------------------
2024-12-23 07:13:53,022 - INFO - Got git diff for instance sphinx-doc__sphinx-10435:
--------

--------
2024-12-23 07:13:58,590 - INFO - Using instance container image: docker.io/xingyaoww/sweb.eval.x86_64.sphinx-doc_s_sphinx-10614. Please make sure this image exists. Submit an issue on https://github.com/All-Hands-AI/OpenHands if you run into any issues.
2024-12-23 07:13:58,590 - INFO - Logging LLM completions for instance sphinx-doc__sphinx-10614 to evaluation/evaluation_outputs/outputs/princeton-nlp__SWE-bench_Verified-test/CodeActAgent/o1_maxiter_30_N_v0.16.0-no-hint-run_1/llm_completions/sphinx-doc__sphinx-10614
2024-12-24 08:10:24,725 - INFO - Building image: ghcr.io/all-hands-ai/runtime:oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm
2024-12-24 08:19:25,055 - INFO - Building image: ghcr.io/all-hands-ai/runtime:oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm
2024-12-24 08:21:35,301 - INFO - Image [ghcr.io/all-hands-ai/runtime:oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm] build finished.
2024-12-24 08:21:35,309 - INFO - Re-tagged image [ghcr.io/all-hands-ai/runtime:oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm] with more generic tag [oh_v0.16.0_o4l1rb3zblhp7jbn]
2024-12-24 08:21:35,311 - INFO - Image ghcr.io/all-hands-ai/runtime with tags [oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm, oh_v0.16.0_o4l1rb3zblhp7jbn] built successfully
2024-12-24 08:21:35,318 - INFO - [runtime 935319b8-209f-4a37-8539-d19fc85b2923-938bba2fd23d8f75] Starting runtime with image: ghcr.io/all-hands-ai/runtime:oh_v0.16.0_o4l1rb3zblhp7jbn_yajo72un47o9ydtm
2024-12-24 08:21:35,754 - INFO - [runtime 935319b8-209f-4a37-8539-d19fc85b2923-938bba2fd23d8f75] Container started: openhands-runtime-935319b8-209f-4a37-8539-d19fc85b2923-938bba2fd23d8f75. VSCode URL: None
2024-12-24 08:21:35,757 - INFO - [runtime 935319b8-209f-4a37-8539-d19fc85b2923-938bba2fd23d8f75] Waiting for client to become ready at http://localhost:30602...
2024-12-24 08:21:53,809 - INFO - [runtime 935319b8-209f-4a37-8539-d19fc85b2923-938bba2fd23d8f75] Runtime is ready.
2024-12-24 08:21:53,926 - INFO - ------------------------------
2024-12-24 08:21:53,926 - INFO - BEGIN Runtime Initialization Fn
2024-12-24 08:21:53,926 - INFO - ------------------------------
2024-12-24 08:21:53,926 - INFO - **CmdRunAction (source=None)**
COMMAND:
echo 'export SWE_INSTANCE_ID=sphinx-doc__sphinx-10435' >> ~/.bashrc && echo 'export PIP_CACHE_DIR=~/.cache/pip' >> ~/.bashrc && echo "alias git='git --no-pager'" >> ~/.bashrc
2024-12-24 08:21:54,033 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-24 08:21:54,034 - INFO - **CmdRunAction (source=None)**
COMMAND:
export USER=$(whoami); echo USER=${USER} 
2024-12-24 08:21:54,140 - INFO - **CmdOutputObservation (source=None, exit code=0)**
USER=root
2024-12-24 08:21:54,141 - INFO - **CmdRunAction (source=None)**
COMMAND:
mkdir -p /swe_util/eval_data/instances
2024-12-24 08:21:54,247 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-24 08:21:54,254 - INFO - **CmdRunAction (source=None)**
COMMAND:
cat ~/.bashrc
2024-12-24 08:21:54,361 - INFO - **CmdOutputObservation (source=None, exit code=0)**
source /opt/miniconda3/etc/profile.d/conda.sh && conda activate testbed
export SWE_INSTANCE_ID=sphinx-doc__sphinx-10435
export PIP_CACHE_DIR=~/.cache/pip
alias git='git --no-pager'
2024-12-24 08:21:54,361 - INFO - **CmdRunAction (source=None)**
COMMAND:
source ~/.bashrc
2024-12-24 08:21:54,561 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-24 08:21:54,561 - INFO - **CmdRunAction (source=None)**
COMMAND:
source /swe_util/instance_swe_entry.sh
2024-12-24 08:21:55,039 - INFO - **CmdOutputObservation (source=None, exit code=0)**
WORKSPACE_NAME: sphinx-doc__sphinx__5.0
2024-12-24 08:21:55,039 - INFO - **CmdRunAction (source=None)**
COMMAND:
cd /workspace/sphinx-doc__sphinx__5.0
2024-12-24 08:21:55,143 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-24 08:21:55,144 - INFO - **CmdRunAction (source=None)**
COMMAND:
git reset --hard
2024-12-24 08:21:55,435 - INFO - **CmdOutputObservation (source=None, exit code=0)**
HEAD is now at f1061c012 Merge pull request #10365 from LuisBL/10363-sphinxmaketitle-should-use-linewidth-fix
2024-12-24 08:21:55,435 - INFO - **CmdRunAction (source=None)**
COMMAND:
for remote_name in $(git remote); do git remote remove "${remote_name}"; done
2024-12-24 08:21:55,543 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-24 08:21:55,543 - INFO - ------------------------------
2024-12-24 08:21:55,543 - INFO - END Runtime Initialization Fn
2024-12-24 08:21:55,543 - INFO - ------------------------------
2024-12-24 08:21:55,544 - INFO - Function calling not enabled for model openai/neulab/o1. Mocking function calling via prompting.
2024-12-24 08:21:55,547 - INFO - [Agent Controller default] Starting step loop...
2024-12-24 08:21:55,548 - INFO - [Agent Controller default] Setting agent(CodeActAgent) state from AgentState.LOADING to AgentState.RUNNING
2024-12-24 08:21:56,649 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 0 GLOBAL STEP 0
2024-12-24 08:22:06,009 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 1 GLOBAL STEP 1
2024-12-24 08:22:25,946 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 2 GLOBAL STEP 2
2024-12-24 08:32:32,816 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 3 GLOBAL STEP 3
2024-12-24 08:32:54,506 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 4 GLOBAL STEP 4
2024-12-24 08:33:21,549 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 5 GLOBAL STEP 5
2024-12-24 08:44:16,408 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 6 GLOBAL STEP 6
2024-12-24 08:45:19,069 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 7 GLOBAL STEP 7
2024-12-24 08:46:17,756 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 8 GLOBAL STEP 8
2024-12-24 08:47:04,362 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 9 GLOBAL STEP 9
2024-12-24 08:47:15,059 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 10 GLOBAL STEP 10
2024-12-24 09:07:26,511 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 11 GLOBAL STEP 11
2024-12-24 09:17:36,069 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 12 GLOBAL STEP 12
2024-12-24 09:17:54,478 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 13 GLOBAL STEP 13
2024-12-24 09:18:08,263 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 14 GLOBAL STEP 14
2024-12-24 09:28:24,480 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 15 GLOBAL STEP 15
2024-12-24 09:29:10,909 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 16 GLOBAL STEP 16
2024-12-24 09:29:46,769 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 17 GLOBAL STEP 17
2024-12-24 09:40:04,380 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 18 GLOBAL STEP 18
2024-12-24 09:40:35,973 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 19 GLOBAL STEP 19
2024-12-24 09:41:04,553 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 20 GLOBAL STEP 20
2024-12-24 09:41:25,634 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 21 GLOBAL STEP 21
2024-12-24 09:41:48,673 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 22 GLOBAL STEP 22
2024-12-24 09:52:02,577 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 23 GLOBAL STEP 23
2024-12-24 09:52:24,004 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 24 GLOBAL STEP 24
2024-12-24 09:53:07,352 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 25 GLOBAL STEP 25
2024-12-24 09:53:14,390 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 26 GLOBAL STEP 26
2024-12-24 10:13:24,614 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 27 GLOBAL STEP 27
2024-12-24 10:13:39,151 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 28 GLOBAL STEP 28
2024-12-24 10:13:46,324 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 29 GLOBAL STEP 29
2024-12-24 10:13:56,486 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 30 GLOBAL STEP 30
2024-12-24 10:13:56,487 - INFO - [Agent Controller default] Setting agent(CodeActAgent) state from AgentState.RUNNING to AgentState.ERROR
2024-12-24 10:13:56,487 - ERROR - Agent reached maximum iteration in headless mode. Current iteration: 30, max iteration: 30
2024-12-24 10:13:56,487 - INFO - [Agent Controller default] Setting agent(CodeActAgent) state from AgentState.ERROR to AgentState.ERROR
2024-12-24 10:13:57,171 - INFO - ------------------------------
2024-12-24 10:13:57,172 - INFO - BEGIN Runtime Completion Fn
2024-12-24 10:13:57,172 - INFO - ------------------------------
2024-12-24 10:13:57,172 - INFO - **CmdRunAction (source=None)**
COMMAND:
cd /workspace/sphinx-doc__sphinx__5.0
2024-12-24 10:13:57,277 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-24 10:13:57,277 - INFO - **CmdRunAction (source=None)**
COMMAND:
git config --global core.pager ""
2024-12-24 10:13:57,384 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-24 10:13:57,384 - INFO - **CmdRunAction (source=None)**
COMMAND:
git add -A
2024-12-24 10:13:57,580 - INFO - **CmdOutputObservation (source=None, exit code=0)**

2024-12-24 10:13:57,580 - INFO - **CmdRunAction (source=None)**
COMMAND:
git diff --no-color --cached f1061c012e214f16fd8790dec3c283d787e3daa8
2024-12-24 10:13:57,691 - INFO - **CmdOutputObservation (source=None, exit code=0)**
diff --git a/reproduce_latex_bug.py b/reproduce_latex_bug.py
new file mode 100644
index 000000000..c9e3f8ee7
--- /dev/null
+++ b/reproduce_latex_bug.py
@@ -0,0 +1,30 @@
+import subprocess
+import os
+
+def main():
+    # Install the local Sphinx code so that our edits will be used
+    subprocess.run(["pip", "install", "-e", "."], cwd=os.path.dirname(__file__), check=True)
+
+    # Create a small test project
+    os.makedirs("test-latex", exist_ok=True)
+
+    with open("test-latex/conf.py", "w") as f:
+        f.write("extensions = ['sphinx.ext.autodoc']\\n")
+
+    with open("test-latex/index.rst", "w") as f:
+        f.write(".. role:: python(code)\\n"
+                "   :language: python\\n"
+                "   :class: highlight\\n"
+                "\\n"
+                "Inline :python:`def foo(1 + 2 + None + \\\"abc\\\"): pass` code block\\n"
+                "\\n"
+                ".. code-block:: python\\n"
+                "\\n"
+                "   def foo(1 + 2 + None + \\\"abc\\\"): pass\\n")
+
+    # Build LaTeX to trigger the bug
+    subprocess.run(["sphinx-build", "-b", "latex", "test-latex", "test-latex/_build/latex"], check=True)
+    print("Build done. Check test-latex/_build/latex/index.tex for extra spaces in inline code if the bug is present.")
+
+if __name__ == "__main__":
+    main()
\ No newline at end of file
diff --git a/sphinx/writers/latex.py b/sphinx/writers/latex.py
index e0c7d56f8..11a7a0ce8 100644
--- a/sphinx/writers/latex.py
+++ b/sphinx/writers/latex.py
@@ -721,10 +721,10 @@ class LaTeXTranslator(SphinxTranslator):
         pass
 
     def visit_desc_inline(self, node: Element) -> None:
-        self.body.append(r'\sphinxcode{\sphinxupquote{')
+        self.body.append(r'\sphinxcode{\sphinxupquote{%')
 
     def depart_desc_inline(self, node: Element) -> None:
-        self.body.append('}}')
+        self.body.append('%}}')
 
     # Nodes for high-level structure in signatures
     ##############################################
@@ -738,11 +738,11 @@ class LaTeXTranslator(SphinxTranslator):
         self.literal_whitespace -= 1
 
     def visit_desc_addname(self, node: Element) -> None:
-        self.body.append(r'\sphinxcode{\sphinxupquote{')
+        self.body.append(r'\sphinxcode{\sphinxupquote{%')
         self.literal_whitespace += 1
 
     def depart_desc_addname(self, node: Element) -> None:
-        self.body.append('}}')
+        self.body.append('%}}')
         self.literal_whitespace -= 1
 
     def visit_desc_type(self, node: Element) -> None:
diff --git a/test-latex/conf.py b/test-latex/conf.py
new file mode 100644
index 000000000..621b43dc9
--- /dev/null
+++ b/test-latex/conf.py
@@ -0,0 +1 @@
+extensions = ['sphinx.ext.autodoc']\n
\ No newline at end of file
diff --git a/test-latex/index.rst b/test-latex/index.rst
new file mode 100644
index 000000000..2a787c8d9
--- /dev/null
+++ b/test-latex/index.rst
@@ -0,0 +1 @@
+.. role:: python(code)\n   :language: python\n   :class: highlight\n\nInline :python:`def foo(1 + 2 + None + \"abc\"): pass` code block\n\n.. code-block:: python\n\n   def foo(1 + 2 + None + \"abc\"): pass\n
\ No newline at end of file
2024-12-24 10:13:57,695 - INFO - ------------------------------
2024-12-24 10:13:57,695 - INFO - END Runtime Completion Fn
2024-12-24 10:13:57,695 - INFO - ------------------------------
2024-12-24 10:13:57,695 - INFO - Got git diff for instance sphinx-doc__sphinx-10435:
--------
diff --git a/reproduce_latex_bug.py b/reproduce_latex_bug.py
new file mode 100644
index 000000000..c9e3f8ee7
--- /dev/null
+++ b/reproduce_latex_bug.py
@@ -0,0 +1,30 @@
+import subprocess
+import os
+
+def main():
+    # Install the local Sphinx code so that our edits will be used
+    subprocess.run(["pip", "install", "-e", "."], cwd=os.path.dirname(__file__), check=True)
+
+    # Create a small test project
+    os.makedirs("test-latex", exist_ok=True)
+
+    with open("test-latex/conf.py", "w") as f:
+        f.write("extensions = ['sphinx.ext.autodoc']\\n")
+
+    with open("test-latex/index.rst", "w") as f:
+        f.write(".. role:: python(code)\\n"
+                "   :language: python\\n"
+                "   :class: highlight\\n"
+                "\\n"
+                "Inline :python:`def foo(1 + 2 + None + \\\"abc\\\"): pass` code block\\n"
+                "\\n"
+                ".. code-block:: python\\n"
+                "\\n"
+                "   def foo(1 + 2 + None + \\\"abc\\\"): pass\\n")
+
+    # Build LaTeX to trigger the bug
+    subprocess.run(["sphinx-build", "-b", "latex", "test-latex", "test-latex/_build/latex"], check=True)
+    print("Build done. Check test-latex/_build/latex/index.tex for extra spaces in inline code if the bug is present.")
+
+if __name__ == "__main__":
+    main()
\ No newline at end of file
diff --git a/sphinx/writers/latex.py b/sphinx/writers/latex.py
index e0c7d56f8..11a7a0ce8 100644
--- a/sphinx/writers/latex.py
+++ b/sphinx/writers/latex.py
@@ -721,10 +721,10 @@ class LaTeXTranslator(SphinxTranslator):
         pass
 
     def visit_desc_inline(self, node: Element) -> None:
-        self.body.append(r'\sphinxcode{\sphinxupquote{')
+        self.body.append(r'\sphinxcode{\sphinxupquote{%')
 
     def depart_desc_inline(self, node: Element) -> None:
-        self.body.append('}}')
+        self.body.append('%}}')
 
     # Nodes for high-level structure in signatures
     ##############################################
@@ -738,11 +738,11 @@ class LaTeXTranslator(SphinxTranslator):
         self.literal_whitespace -= 1
 
     def visit_desc_addname(self, node: Element) -> None:
-        self.body.append(r'\sphinxcode{\sphinxupquote{')
+        self.body.append(r'\sphinxcode{\sphinxupquote{%')
         self.literal_whitespace += 1
 
     def depart_desc_addname(self, node: Element) -> None:
-        self.body.append('}}')
+        self.body.append('%}}')
         self.literal_whitespace -= 1
 
     def visit_desc_type(self, node: Element) -> None:
diff --git a/test-latex/conf.py b/test-latex/conf.py
new file mode 100644
index 000000000..621b43dc9
--- /dev/null
+++ b/test-latex/conf.py
@@ -0,0 +1 @@
+extensions = ['sphinx.ext.autodoc']\n
\ No newline at end of file
diff --git a/test-latex/index.rst b/test-latex/index.rst
new file mode 100644
index 000000000..2a787c8d9
--- /dev/null
+++ b/test-latex/index.rst
@@ -0,0 +1 @@
+.. role:: python(code)\n   :language: python\n   :class: highlight\n\nInline :python:`def foo(1 + 2 + None + \"abc\"): pass` code block\n\n.. code-block:: python\n\n   def foo(1 + 2 + None + \"abc\"): pass\n
\ No newline at end of file
--------
2024-12-24 10:14:03,055 - INFO - Using instance container image: docker.io/xingyaoww/sweb.eval.x86_64.sphinx-doc_s_sphinx-11510. Please make sure this image exists. Submit an issue on https://github.com/All-Hands-AI/OpenHands if you run into any issues.
2024-12-24 10:14:03,057 - INFO - Logging LLM completions for instance sphinx-doc__sphinx-11510 to evaluation/evaluation_outputs/outputs/princeton-nlp__SWE-bench_Verified-test/CodeActAgent/o1_maxiter_30_N_v0.16.0-no-hint-run_1/llm_completions/sphinx-doc__sphinx-11510
