2025-01-14 19:08:43,667 - INFO - Building image: ghcr.io/all-hands-ai/runtime:oh_v0.20.0_ww98r9350ujwwmvf_qroup3d3os79ipoo
2025-01-14 19:10:49,871 - INFO - Image [ghcr.io/all-hands-ai/runtime:oh_v0.20.0_ww98r9350ujwwmvf_qroup3d3os79ipoo] build finished.
2025-01-14 19:10:49,886 - INFO - Re-tagged image [ghcr.io/all-hands-ai/runtime:oh_v0.20.0_ww98r9350ujwwmvf_qroup3d3os79ipoo] with more generic tag [oh_v0.20.0_ww98r9350ujwwmvf]
2025-01-14 19:10:49,888 - INFO - Image ghcr.io/all-hands-ai/runtime with tags [oh_v0.20.0_ww98r9350ujwwmvf_qroup3d3os79ipoo, oh_v0.20.0_ww98r9350ujwwmvf] built successfully
2025-01-14 19:10:49,896 - INFO - [runtime e25c4d9c-45d6-43c4-b04f-df3a832e88af-7d573e103c564938] Starting runtime with image: ghcr.io/all-hands-ai/runtime:oh_v0.20.0_ww98r9350ujwwmvf_qroup3d3os79ipoo
2025-01-14 19:10:51,434 - INFO - [runtime e25c4d9c-45d6-43c4-b04f-df3a832e88af-7d573e103c564938] Container started: openhands-runtime-e25c4d9c-45d6-43c4-b04f-df3a832e88af-7d573e103c564938. VSCode URL: None
2025-01-14 19:10:51,434 - INFO - [runtime e25c4d9c-45d6-43c4-b04f-df3a832e88af-7d573e103c564938] Waiting for client to become ready at http://localhost:30885...
2025-01-14 19:11:15,505 - INFO - [runtime e25c4d9c-45d6-43c4-b04f-df3a832e88af-7d573e103c564938] Runtime is ready.
2025-01-14 19:11:16,149 - INFO - ------------------------------
2025-01-14 19:11:16,149 - INFO - BEGIN Runtime Initialization Fn
2025-01-14 19:11:16,149 - INFO - ------------------------------
2025-01-14 19:11:16,149 - INFO - **CmdRunAction (source=None)**
COMMAND:
echo 'export SWE_INSTANCE_ID=sympy__sympy-24066' >> ~/.bashrc && echo 'export PIP_CACHE_DIR=~/.cache/pip' >> ~/.bashrc && echo "alias git='git --no-pager'" >> ~/.bashrc
2025-01-14 19:11:16,777 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:11:16,778 - INFO - **CmdRunAction (source=None)**
COMMAND:
export USER=$(whoami); echo USER=${USER} 
2025-01-14 19:11:17,403 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
USER=root
[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:11:17,404 - INFO - **CmdRunAction (source=None)**
COMMAND:
mkdir -p /swe_util/eval_data/instances
2025-01-14 19:11:18,030 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:11:18,039 - INFO - **CmdRunAction (source=None)**
COMMAND:
cat ~/.bashrc
2025-01-14 19:11:18,666 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
source /opt/miniconda3/etc/profile.d/conda.sh && conda activate testbed
export SWE_INSTANCE_ID=sympy__sympy-24066
export PIP_CACHE_DIR=~/.cache/pip
alias git='git --no-pager'
[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:11:18,666 - INFO - **CmdRunAction (source=None)**
COMMAND:
source ~/.bashrc
2025-01-14 19:11:19,294 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:11:19,295 - WARNING - Timeout greater than 600 seconds may not be supported by the runtime. Consider setting a lower timeout.
2025-01-14 19:11:19,295 - INFO - **CmdRunAction (source=None)**
COMMAND:
source /swe_util/instance_swe_entry.sh
2025-01-14 19:11:20,429 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
WORKSPACE_NAME: sympy__sympy__1.12
[The command completed with exit code 0.]
[Current working directory: /workspace]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:11:20,429 - INFO - **CmdRunAction (source=None)**
COMMAND:
cd /workspace/sympy__sympy__1.12
2025-01-14 19:11:20,555 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace/sympy__sympy__1.12",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/sympy__sympy__1.12]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:11:20,558 - INFO - **CmdRunAction (source=None)**
COMMAND:
git reset --hard
2025-01-14 19:11:21,192 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace/sympy__sympy__1.12",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
HEAD is now at 514579c655 Merge pull request #24076 from smichr/pwe
[The command completed with exit code 0.]
[Current working directory: /workspace/sympy__sympy__1.12]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:11:21,192 - INFO - **CmdRunAction (source=None)**
COMMAND:
for remote_name in $(git remote); do git remote remove "${remote_name}"; done
2025-01-14 19:11:21,822 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace/sympy__sympy__1.12",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/sympy__sympy__1.12]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:11:21,822 - INFO - **CmdRunAction (source=None)**
COMMAND:
which python
2025-01-14 19:11:22,448 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace/sympy__sympy__1.12",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
/opt/miniconda3/envs/testbed/bin/python
[The command completed with exit code 0.]
[Current working directory: /workspace/sympy__sympy__1.12]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:11:22,449 - INFO - ------------------------------
2025-01-14 19:11:22,449 - INFO - END Runtime Initialization Fn
2025-01-14 19:11:22,449 - INFO - ------------------------------
2025-01-14 19:11:22,463 - INFO - [runtime e25c4d9c-45d6-43c4-b04f-df3a832e88af-7d573e103c564938] Found 0 local microagents.
2025-01-14 19:11:22,464 - INFO - [Agent Controller default] Setting agent(CodeActAgent) state from AgentState.LOADING to AgentState.RUNNING
2025-01-14 19:11:22,465 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 0 GLOBAL STEP 0
2025-01-14 19:11:43,228 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 1 GLOBAL STEP 1
2025-01-14 19:11:58,271 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 2 GLOBAL STEP 2
2025-01-14 19:12:16,489 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 3 GLOBAL STEP 3
2025-01-14 19:12:35,125 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 4 GLOBAL STEP 4
2025-01-14 19:13:05,969 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 5 GLOBAL STEP 5
2025-01-14 19:13:38,873 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 6 GLOBAL STEP 6
2025-01-14 19:15:15,379 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 7 GLOBAL STEP 7
2025-01-14 19:15:23,764 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 8 GLOBAL STEP 8
2025-01-14 19:15:30,214 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 9 GLOBAL STEP 9
2025-01-14 19:16:44,177 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 10 GLOBAL STEP 10
2025-01-14 19:17:39,350 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 11 GLOBAL STEP 11
2025-01-14 19:17:55,632 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 12 GLOBAL STEP 12
2025-01-14 19:18:10,516 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 13 GLOBAL STEP 13
2025-01-14 19:19:10,296 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 14 GLOBAL STEP 14
2025-01-14 19:19:20,280 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 15 GLOBAL STEP 15
2025-01-14 19:19:50,399 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 16 GLOBAL STEP 16
2025-01-14 19:20:00,201 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 17 GLOBAL STEP 17
2025-01-14 19:20:13,974 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 18 GLOBAL STEP 18
2025-01-14 19:20:17,504 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 19 GLOBAL STEP 19
2025-01-14 19:20:53,215 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 20 GLOBAL STEP 20
2025-01-14 19:21:37,465 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 21 GLOBAL STEP 21
2025-01-14 19:22:00,738 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 22 GLOBAL STEP 22
2025-01-14 19:22:10,679 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 23 GLOBAL STEP 23
2025-01-14 19:22:23,440 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 24 GLOBAL STEP 24
2025-01-14 19:22:31,258 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 25 GLOBAL STEP 25
2025-01-14 19:22:36,611 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 26 GLOBAL STEP 26
2025-01-14 19:22:40,999 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 27 GLOBAL STEP 27
2025-01-14 19:23:09,109 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 28 GLOBAL STEP 28
2025-01-14 19:23:17,267 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 29 GLOBAL STEP 29
2025-01-14 19:23:22,560 - INFO - [Agent Controller default] LEVEL 0 LOCAL STEP 30 GLOBAL STEP 30
2025-01-14 19:23:22,561 - INFO - [Agent Controller default] Setting agent(CodeActAgent) state from AgentState.RUNNING to AgentState.ERROR
2025-01-14 19:23:22,561 - ERROR - RuntimeError: Agent reached maximum iteration in headless mode. Current iteration: 30, max iteration: 30
2025-01-14 19:23:22,562 - WARNING - Stopping agent due to traffic control
2025-01-14 19:23:22,562 - INFO - [Agent Controller default] Setting agent(CodeActAgent) state from AgentState.ERROR to AgentState.ERROR
2025-01-14 19:23:23,190 - INFO - ------------------------------
2025-01-14 19:23:23,190 - INFO - BEGIN Runtime Completion Fn
2025-01-14 19:23:23,190 - INFO - ------------------------------
2025-01-14 19:23:23,190 - INFO - **CmdRunAction (source=None)**
COMMAND:
cd /workspace/sympy__sympy__1.12
2025-01-14 19:23:23,819 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace/sympy__sympy__1.12",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/sympy__sympy__1.12]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:23:23,820 - INFO - **CmdRunAction (source=None)**
COMMAND:
git config --global core.pager ""
2025-01-14 19:23:24,445 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace/sympy__sympy__1.12",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/sympy__sympy__1.12]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:23:24,445 - INFO - **CmdRunAction (source=None)**
COMMAND:
git add -A
2025-01-14 19:23:25,070 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace/sympy__sympy__1.12",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--

[The command completed with exit code 0.]
[Current working directory: /workspace/sympy__sympy__1.12]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:23:25,070 - INFO - **CmdRunAction (source=None)**
COMMAND:
git diff --no-color --cached 514579c655bf22e2af14f0743376ae1d7befe345
2025-01-14 19:23:25,697 - INFO - **CmdOutputObservation (source=None, exit code=0, metadata={
  "exit_code": 0,
  "pid": -1,
  "username": "root",
  "hostname": "13462aaf2878",
  "working_dir": "/workspace/sympy__sympy__1.12",
  "py_interpreter_path": "/opt/miniconda3/envs/testbed/bin/python",
  "prefix": "",
  "suffix": "\n[The command completed with exit code 0.]"
})**
--BEGIN AGENT OBSERVATION--
diff --git a/reproduce_bug.py b/reproduce_bug.py
new file mode 100644
index 0000000000..25a7458359
--- /dev/null
+++ b/reproduce_bug.py
@@ -0,0 +1,14 @@
+from sympy import exp
+from sympy.physics import units
+from sympy.physics.units.systems.si import SI
+
+expr = units.second / (units.ohm * units.farad)
+print('Dimension of expr:', SI._collect_factor_and_dimension(expr)[1])
+assert SI.get_dimension_system().is_dimensionless(SI._collect_factor_and_dimension(expr)[1]), "expr should be dimensionless"
+
+buggy_expr = 100 + exp(expr)
+print('Dimension of exp(expr):', SI._collect_factor_and_dimension(exp(expr))[1])
+print('Attempting to collect factor and dimension of 100 + exp(expr)...')
+res = SI._collect_factor_and_dimension(buggy_expr)
+print('Result:', res)
+
diff --git a/sympy/physics/units/definitions/dimension_definitions.py b/sympy/physics/units/definitions/dimension_definitions.py
index c9950d5855..ea9b14a110 100644
--- a/sympy/physics/units/definitions/dimension_definitions.py
+++ b/sympy/physics/units/definitions/dimension_definitions.py
@@ -30,14 +30,26 @@
 volume = Dimension("volume")

 # derived dimensions (MKSA not in MKS)
-voltage = Dimension(name='voltage', symbol='U')  # type: Dimension
-impedance = Dimension(name='impedance', symbol='Z')  # type: Dimension
-conductance = Dimension(name='conductance', symbol='G')  # type: Dimension
-capacitance = Dimension(name='capacitance')  # type: Dimension
-inductance = Dimension(name='inductance')  # type: Dimension
-charge = Dimension(name='charge', symbol='Q')  # type: Dimension
+voltage = Dimension({mass:1, length:2, time:-3, current:-1})
+voltage.name = 'voltage'
+voltage.symbol = 'U'
+impedance = Dimension({mass:1, length:2, time:-3, current:-2})
+impedance.name = 'impedance'
+impedance.symbol = 'Z'
+conductance = Dimension({mass:-1, length:-2, time:3, current:2})
+conductance.name = 'conductance'
+conductance.symbol = 'G'
+capacitance = Dimension({mass:-1, length:-2, time:4, current:2}, name='capacitance')
+inductance = Dimension({mass:1, length:2, time:-2, current:-2}, name='inductance')  # type: Dimension
+charge = Dimension(time*current, name='charge', symbol='Q')
 magnetic_density = Dimension(name='magnetic_density', symbol='B')  # type: Dimension
 magnetic_flux = Dimension(name='magnetic_flux')  # type: Dimension

+# Link these derived dimensions to the base ones so that certain expressions become dimensionless.
+from sympy.physics.units.definitions.dimension_definitions import mass, length, time, current
+charge.set_dimensional_dependencies({mass: 0, length: 0, time: 1, current: 1})
+voltage.set_dimensional_dependencies({mass: 1, length: 2, time: -3, current: -1})
+impedance.set_dimensional_dependencies({mass: 1, length: 2, time: -3, current: -2})
+capacitance.set_dimensional_dependencies({mass: -1, length: -2, time: 4, current: 2})
 # Dimensions in information theory:
 information = Dimension(name='information')  # type: Dimension
diff --git a/sympy/physics/units/systems/si.py b/sympy/physics/units/systems/si.py
index 700495ad9d..691ca96e96 100644
--- a/sympy/physics/units/systems/si.py
+++ b/sympy/physics/units/systems/si.py
@@ -111,10 +111,14 @@
 # MKSA extension to MKS: derived units

 SI.set_quantity_scale_factor(coulomb, One)
+# Ensure that "coulomb" is recognized as current * time, so that expressions like second/(farad*ohm) become dimensionless.
+SI.set_quantity_dimension(coulomb, SI.get_quantity_dimension(ampere)*SI.get_quantity_dimension(second))

 SI.set_quantity_scale_factor(volt, joule/coulomb)

 SI.set_quantity_scale_factor(ohm, volt/ampere)
+SI.set_quantity_dimension(ohm, SI.get_quantity_dimension(volt)/SI.get_quantity_dimension(ampere))
+SI.set_quantity_dimension(farad, SI.get_quantity_dimension(coulomb)/SI.get_quantity_dimension(volt))

 SI.set_quantity_scale_factor(siemens, ampere/volt)
[The command completed with exit code 0.]
[Current working directory: /workspace/sympy__sympy__1.12]
[Python interpreter: /opt/miniconda3/envs/testbed/bin/python]
--END AGENT OBSERVATION--
2025-01-14 19:23:25,697 - INFO - ------------------------------
2025-01-14 19:23:25,697 - INFO - END Runtime Completion Fn
2025-01-14 19:23:25,698 - INFO - ------------------------------
2025-01-14 19:23:25,698 - INFO - Got git diff for instance sympy__sympy-24066:
--------
diff --git a/reproduce_bug.py b/reproduce_bug.py
new file mode 100644
index 0000000000..25a7458359
--- /dev/null
+++ b/reproduce_bug.py
@@ -0,0 +1,14 @@
+from sympy import exp
+from sympy.physics import units
+from sympy.physics.units.systems.si import SI
+
+expr = units.second / (units.ohm * units.farad)
+print('Dimension of expr:', SI._collect_factor_and_dimension(expr)[1])
+assert SI.get_dimension_system().is_dimensionless(SI._collect_factor_and_dimension(expr)[1]), "expr should be dimensionless"
+
+buggy_expr = 100 + exp(expr)
+print('Dimension of exp(expr):', SI._collect_factor_and_dimension(exp(expr))[1])
+print('Attempting to collect factor and dimension of 100 + exp(expr)...')
+res = SI._collect_factor_and_dimension(buggy_expr)
+print('Result:', res)
+
diff --git a/sympy/physics/units/definitions/dimension_definitions.py b/sympy/physics/units/definitions/dimension_definitions.py
index c9950d5855..ea9b14a110 100644
--- a/sympy/physics/units/definitions/dimension_definitions.py
+++ b/sympy/physics/units/definitions/dimension_definitions.py
@@ -30,14 +30,26 @@
 volume = Dimension("volume")

 # derived dimensions (MKSA not in MKS)
-voltage = Dimension(name='voltage', symbol='U')  # type: Dimension
-impedance = Dimension(name='impedance', symbol='Z')  # type: Dimension
-conductance = Dimension(name='conductance', symbol='G')  # type: Dimension
-capacitance = Dimension(name='capacitance')  # type: Dimension
-inductance = Dimension(name='inductance')  # type: Dimension
-charge = Dimension(name='charge', symbol='Q')  # type: Dimension
+voltage = Dimension({mass:1, length:2, time:-3, current:-1})
+voltage.name = 'voltage'
+voltage.symbol = 'U'
+impedance = Dimension({mass:1, length:2, time:-3, current:-2})
+impedance.name = 'impedance'
+impedance.symbol = 'Z'
+conductance = Dimension({mass:-1, length:-2, time:3, current:2})
+conductance.name = 'conductance'
+conductance.symbol = 'G'
+capacitance = Dimension({mass:-1, length:-2, time:4, current:2}, name='capacitance')
+inductance = Dimension({mass:1, length:2, time:-2, current:-2}, name='inductance')  # type: Dimension
+charge = Dimension(time*current, name='charge', symbol='Q')
 magnetic_density = Dimension(name='magnetic_density', symbol='B')  # type: Dimension
 magnetic_flux = Dimension(name='magnetic_flux')  # type: Dimension

+# Link these derived dimensions to the base ones so that certain expressions become dimensionless.
+from sympy.physics.units.definitions.dimension_definitions import mass, length, time, current
+charge.set_dimensional_dependencies({mass: 0, length: 0, time: 1, current: 1})
+voltage.set_dimensional_dependencies({mass: 1, length: 2, time: -3, current: -1})
+impedance.set_dimensional_dependencies({mass: 1, length: 2, time: -3, current: -2})
+capacitance.set_dimensional_dependencies({mass: -1, length: -2, time: 4, current: 2})
 # Dimensions in information theory:
 information = Dimension(name='information')  # type: Dimension
diff --git a/sympy/physics/units/systems/si.py b/sympy/physics/units/systems/si.py
index 700495ad9d..691ca96e96 100644
--- a/sympy/physics/units/systems/si.py
+++ b/sympy/physics/units/systems/si.py
@@ -111,10 +111,14 @@
 # MKSA extension to MKS: derived units

 SI.set_quantity_scale_factor(coulomb, One)
+# Ensure that "coulomb" is recognized as current * time, so that expressions like second/(farad*ohm) become dimensionless.
+SI.set_quantity_dimension(coulomb, SI.get_quantity_dimension(ampere)*SI.get_quantity_dimension(second))

 SI.set_quantity_scale_factor(volt, joule/coulomb)

 SI.set_quantity_scale_factor(ohm, volt/ampere)
+SI.set_quantity_dimension(ohm, SI.get_quantity_dimension(volt)/SI.get_quantity_dimension(ampere))
+SI.set_quantity_dimension(farad, SI.get_quantity_dimension(coulomb)/SI.get_quantity_dimension(volt))

 SI.set_quantity_scale_factor(siemens, ampere/volt)
--------
